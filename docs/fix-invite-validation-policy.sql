-- Исправление политики для валидации кодов приглашений
-- Проблема: анонимные пользователи не могут читать таблицу invites для валидации кодов

-- Удаляем старую политику если существует
DROP POLICY IF EXISTS "Anonymous can validate invite codes" ON invites;

-- Создаем новую политику для анонимной валидации кодов приглашений
CREATE POLICY "Anonymous can validate invite codes" ON invites
  FOR SELECT USING (true);

-- Комментарий: эта политика позволяет всем (включая анонимных пользователей) 
-- читать записи из таблицы invites для валидации кодов приглашений при регистрации 